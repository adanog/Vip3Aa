
# Image-Based Dose-Response Analysis of Sf9 Cells Exposed to Bacillus thuringiensis Insecticidal Protein

This repository contains a collection of Jupyter notebooks designed to perform cell segmentation, dose-response analysis, and data visualization for Sf9 cells exposed to **Bacillus thuringiensis** insecticidal protein. The workflow leverages the **Cellpose3** segmentation model to process bright field microscopy images, and subsequent scripts for data analysis and visualization.

## Notebooks Overview

### 1. **240516-cyto3_edited.ipynb**: Cell Segmentation Using Cellpose3
- **Purpose**: This notebook applies the super-generalist **cyto3** model from Cellpose3 for cell segmentation in bright field microscopy images of Sf9 cells.
- **Input**: Bright field microscopy images of Sf9 cells exposed to different concentrations of **Bacillus thuringiensis** insecticidal protein.
- **Output**: Segmentation results, including cell masks and a `summary_report.csv` file containing information on the number of ROIs, median area, and concentration for each image.
- **Dependencies**: Cellpose3, Python 3.x, and Colab with GPU support.
  
### 2. **240601_Dose_response_analysis.ipynb**: Dose-Response Data Analysis
- **Purpose**: This notebook processes the `summary_report.csv` generated from the segmentation results to perform dose-response analysis.
- **Input**: `summary_report.csv` containing segmentation data (number of ROIs, median area, and concentration).
- **Output**: Tables summarizing the dose-response relationships and plots visualizing metrics such as the normalized number of cells and median area.
- **Dependencies**: `pandas`, `statsmodels`, `seaborn`.

### 3. **240601_Plot_dose_response.ipynb**: Dose-Response Plotting
- **Purpose**: This notebook generates visualizations from the processed dose-response data, comparing the effects of **Protox** and **Toxin** on cell counts and median area.
- **Input**: Data from the dose-response analysis, containing concentration, normalized cell counts, median area, and statistical significance for Protox and Toxin.
- **Output**: Bar plots with statistical significance markers and a PDF with generated figures.
- **Dependencies**: `matplotlib`, `seaborn`, `pandas`.

## Getting Started

### Prerequisites
- Python 3.x
- Jupyter Notebook
- Required Python libraries: `cellpose`, `torch`, `pandas`, `matplotlib`, `seaborn`, `statsmodels`.

### Installation
1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/repository_name.git
   cd repository_name
   ```
2. Install the necessary dependencies:
   ```bash
   pip install -r requirements.txt
   ```
   *(Alternatively, install libraries directly in each notebook as needed.)*

3. Use a GPU-enabled environment (e.g., Google Colab) for the cell segmentation notebook to ensure efficient processing.

## Usage

1. **Run Cell Segmentation**:
   - Open `240516-cyto3_edited.ipynb` in Jupyter or Google Colab.
   - Ensure your microscopy images are uploaded and run the segmentation pipeline.
   - Save the `summary_report.csv` generated by the notebook.

2. **Perform Dose-Response Analysis**:
   - Use `240601_Dose_response_analysis.ipynb` to analyze the `summary_report.csv`.
   - Extract dose-response metrics, including cell count and median area.

3. **Visualize Results**:
   - Open `240601_Plot_dose_response.ipynb` to generate dose-response plots comparing Protox and Toxin effects.
   - Save and export the figures as needed.

## License

This project is licensed under the BSD-3-Clause license License.

## Author

Developed by Adan Guerrero (adan.guerrero@ibt.unam.mx) as part of an image-based flow cytometry project using Sf9 cells exposed to insecticidal proteins.
